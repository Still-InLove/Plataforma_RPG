<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taverna da Dragonesa</title>
    <link rel="stylesheet" href="estilo.css?v=1.1">
</head>
<body>
    <header>
        <nav>
            <a href="#" class="logo">Taverna da Dragonesa</a>
            <button class="menu-toggle">
        <span class="hamburger"></span>
    </button>
    <ul>
            <ul>
                <li><a href="#sistemas">Sistemas</a></li>
                <li><a href="#campanhas">Campanhas</a></li>
                <li><a href="#sobre">Sobre</a></li>
                <li><a href="#contato">Contato</a></li>
                <li id="auth-menu">
                    <a href="login.html">Entrar</a> / <a href="cadastro.html">Cadastrar</a>
                </li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="sistemas">
            <h2>Sistemas e Campanhas</h2>
            <div class="grid" id="publicacoes-grid">
                </div>
        </section>

        <section id="sobre">
            <h2>Sobre a Taverna</h2>
            <div class="grid">
                <div class="card">
                    <h3>Missão</h3>
                    <p>Conectar mestres e jogadores para criar histórias inesquecíveis.</p>
                </div>
                <div class="card">
                    <h3>Visão</h3>
                    <p>Ser a maior comunidade de RPG do Brasil, facilitando a criação de jogos e a interação entre os membros.</p>
                </div>
                <div class="card">
                    <h3>Valores</h3>
                    <p>Criatividade, colaboração, respeito e paixão pelo universo do RPG.</p>
                </div>
            </div>
        </section>

        <section id="contato">
            <h2>Contato</h2>
            <form>
                <label for="nome">Nome:</label>
                <input type="text" id="nome" name="nome" required>
                <label for="email">E-mail:</label>
                <input type="email" id="email" name="email" required>
                <label for="mensagem">Mensagem:</label>
                <textarea id="mensagem" name="mensagem" rows="4" required></textarea>
                <button type="submit">Enviar</button>
            </form>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Taverna da Dragonesa. Todos os direitos reservados.</p>
    </footer>

    <script>
    function fazerLogout() {
        localStorage.removeItem('rpghub_token');
        localStorage.removeItem('usuario_nome');
        localStorage.removeItem('usuario_email');
        window.location.href = 'index.html';
    }

    document.addEventListener('DOMContentLoaded', async function() {
        const authMenu = document.getElementById('auth-menu');
        const token = localStorage.getItem('rpghub_token');
        const nomeUsuario = localStorage.getItem('usuario_nome');

        if (token && nomeUsuario) {
            authMenu.innerHTML = `
                <div class="user-profile-menu">
                    <a href="perfil.html" class="profile-link">
                        <img src="https://i.pravatar.cc/50?u=${nomeUsuario}" alt="Foto de Perfil" class="profile-pic">
                    </a>
                    <a href="#" onclick="fazerLogout()" class="logout-link">Sair</a>
                </div>
            `;
        }

        const grid = document.getElementById('publicacoes-grid');

        try {
            const response = await fetch('listar_publicacoes.php');
            const data = await response.json();

            if (data.success && data.publicacoes.length > 0) {
                data.publicacoes.forEach(publicacao => {
                    const card = document.createElement('article');
                    card.className = 'card';
                    card.innerHTML = `
                        <h3>${publicacao.titulo}</h3>
                        <span style='color:#6366f1;font-weight:600;'>${publicacao.tipo}</span>
                        <p>${publicacao.descricao}</p>
                        <p style="margin-top: 1rem;">Autor: ${publicacao.autor_nome}</p>
                    `;
                    grid.appendChild(card);
                });
            } else {
                grid.innerHTML = '<p style="text-align:center; color:#7c3aed;">Nenhuma publicação encontrada.</p>';
            }
        } catch (err) {
            grid.innerHTML = '<p style="text-align:center; color:#7c3aed;">Erro ao carregar publicações.</p>';
        }

        const nav = document.querySelector('nav');
        const menuToggle = document.querySelector('.menu-toggle');
        const navLinks = document.querySelectorAll('nav ul li a');

        if (menuToggle) {
            menuToggle.addEventListener('click', () => {
                nav.classList.toggle('active');
            });
        }

        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                nav.classList.remove('active');
            });
        });
    });
</script>

</body>
</html>